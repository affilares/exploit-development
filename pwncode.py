#!/usr/bin/python3
import sys
import os
from pwn import log

cwd = os.getcwd()
try:
	binary = sys.argv[1]
	exploit_script = sys.argv[2]

except:
	log.critical('pass arguments man!!!')
	log.info('argv [1] => binary file')
	log.info('argv [2] => solve script name (optional)')
	if binary:
		exploit_script = 'solve.py'
		pass
	else:
		sys.exit()

template = f'''#!/usr/bin/python3
from pwn import *

elf = context.binary = ELF('{binary}',checksec=False)
rop = ROP(elf)
p = elf.process()

## pwncode[H4ppy_pWn1nG]
'''

open(cwd+'/'+exploit_script,'w').write(template)
os.system(f'subl {cwd}/{exploit_script}')
# a small script to generate solve.py
# copy this file to /usr/bin/pwncode
